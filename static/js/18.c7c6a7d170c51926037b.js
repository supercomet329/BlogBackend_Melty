webpackJsonp([18],{"0AAv":function(t,o,e){"use strict";function s(t){e("eYWL")}Object.defineProperty(o,"__esModule",{value:!0});var i=e("qPx5"),a=e.n(i);for(var n in i)"default"!==n&&function(t){e.d(o,t,function(){return i[t]})}(n);var r=e("KA+h"),c=e("VU/8"),l=s,u=c(a.a,r.a,!1,l,null,null);o.default=u.exports},"KA+h":function(t,o,e){"use strict";var s=function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{staticClass:"book-list-content layout-content"},[e("iv-row",[e("iv-col",{attrs:{xs:24,sm:24,md:24,lg:17}},[e("div",{staticClass:"layout-left"},[e("classify-menu",{attrs:{categorys:t.categorys,defaultCategory:t.top_category},on:{selectCategory:t.selectCategory}}),t._v(" "),e("iv-affix",{staticStyle:{position:"relative","z-index":"12"}},[e("section-title",{attrs:{mainTitle:"图书列表",subTitle:"Books",menus:t.booksMenus,withRefresh:!0,withTimeSelect:!0,datePickerOptions:t.booksDatePickerOptions},on:{refresh:t.refreshBooks,menusControl:t.booksMenusControl,comfirmDateSelect:t.booksDateSelect,clearDateSelect:t.booksDateSelectClear}})],1),t._v(" "),t._l(t.books,function(t){return e("book-cell",{key:t.id,attrs:{book:t}})}),t._v(" "),e("browse-more",{ref:"browseMoreBooks",on:{browseMore:t.browseMoreBooks}})],2)]),t._v(" "),e("iv-col",{attrs:{xs:0,sm:0,md:0,lg:7}},[e("div",{staticClass:"layout-right"},[e("recommend"),t._v(" "),e("tag-wall",{staticStyle:{"margin-top":"15px"}})],1)])],1)],1)},i=[],a={render:s,staticRenderFns:i};o.a=a},eYWL:function(t,o,e){var s=e("tNQJ");"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);e("rjj0")("015b1124",s,!0)},qPx5:function(t,o,e){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(o,"__esModule",{value:!0});var i=e("nGNg"),a=s(i),n=e("NXNv"),r=s(n),c=e("SLXF"),l=s(c),u=e("qm2k"),m=s(u),k=e("XxWu"),h=s(k),d=e("63Js"),b=s(d),f=e("P9l9");o.default={data:function(){return{books:[],bookNotes:[],categorys:void 0,top_category:void 0,limit_size:10,booksTimeSorted:!1,booksMostComment:void 0,booksRecommend:void 0,booksPage:0,booksTotalCount:0,noMoreBooksData:!1,booksMenus:[{title:"顺序",selectedTitle:"逆序",selected:!0,method:"timeSorted"},{title:"评论最多",selected:!1,method:"mostComment"},{title:"推荐",selected:!1,method:"recommend"}],booksDatePickerOptions:{disabledDate:function(t){return t&&t.valueOf()>Date.now()},shortcuts:[{text:"近一周",value:function(){var t=new Date,o=new Date;return o.setTime(o.getTime()-6048e5),[o,t]}},{text:"近一个月",value:function(){var t=new Date,o=new Date;return o.setTime(o.getTime()-2592e6),[o,t]}},{text:"近三个月",value:function(){var t=new Date,o=new Date;return o.setTime(o.getTime()-7776e6),[o,t]}},{text:"近一年",value:function(){var t=new Date,o=new Date;return o.setTime(o.getTime()-31536e6),[o,t]}}]},booksSelectedDateRange:[]}},created:function(){this.top_category=parseInt(this.$route.params.id),this.getDatas()},methods:{selectCategory:function(t){this.top_category=t,this.booksTimeSorted=!1,this.booksMostComment=void 0,this.booksRecommend=void 0,this.booksPage=0,this.books=[],this.booksTotalCount=0,this.noMoreBooksData=!1,this.booksSelectedDateRange=[],this.getBookBaseInfo()},getDatas:function(){this.getCategorys(),this.getBookBaseInfo()},getCategorys:function(){var t=this;(0,f.getCategorys)({params:{level_min:1,level_max:1,id:this.$Window.__category_info__.reading}}).then(function(o){t.categorys=o.data.results}).catch(function(t){})},getBookBaseInfo:function(){var t=this;if(!this.noMoreBooksData){var o=[];this.booksTimeSorted?o.push("add_time"):o.push("-add_time"),void 0!==this.booksMostComment&&(this.booksMostComment?o.push("comment_num"):o.push("-comment_num")),(0,f.getBookBaseInfo)({params:{top_category:this.top_category,ordering:o.toString(),is_recommend:!1,time_min:this.booksSelectedDateRange[0],time_max:this.booksSelectedDateRange[1],limit:this.limit_size,offset:this.booksPage*this.limit_size}}).then(function(o){t.books=t.books.concat(o.data.results),t.booksTotalCount+=o.data.results.length,t.noMoreBooksData=t.booksTotalCount>=o.data.count,t.$refs.browseMoreBooks.stopLoading(t.noMoreBooksData)}).catch(function(t){})}},browseMoreBooks:function(){this.booksPage++,this.getBookBaseInfo()},refreshBooks:function(){this.top_category=parseInt(this.$route.params.id),this.booksTimeSorted=!1,this.booksMostComment=void 0,this.booksRecommend=void 0,this.booksPage=0,this.books=[],this.booksTotalCount=0,this.noMoreBooksData=!1,this.booksSelectedDateRange=[],this.getCategorys(),this.getBookBaseInfo()},booksMenusControl:function(t){switch(t[0]){case"timeSorted":this.booksTimeSorted=!t[1];break;case"mostComment":this.booksMostComment=t[1];break;case"recommend":this.booksRecommend=t[1]}this.booksPage=0,this.books=[],this.booksTotalCount=0,this.noMoreBooksData=!1,this.getBookBaseInfo()},booksDateSelect:function(t){this.booksSelectedDateRange=t,this.booksPage=0,this.limit_size=10,this.books=[],this.booksTotalCount=0,this.noMoreBooksData=!1,this.getBookBaseInfo()},booksDateSelectClear:function(){this.booksSelectedDateRange=[],this.booksPage=0,this.limit_size=10,this.books=[],this.booksTotalCount=0,this.noMoreBooksData=!1,this.getBookBaseInfo()}},components:{"book-cell":a.default,"classify-menu":r.default,"section-title":l.default,recommend:m.default,"tag-wall":h.default,"browse-more":b.default}}},tNQJ:function(t,o,e){o=t.exports=e("FZ+f")(!0),o.push([t.i,"","",{version:3,sources:[],names:[],mappings:"",file:"BookListContent.vue",sourceRoot:""}])}});